version: "3"
services:
  pail:
    container_name: pail
    image: kittyandrew/pail:latest
    restart: always
    # Expose port for direct access (remove if using a reverse proxy on the same Docker network)
    ports:
      - "8080:8080"
    volumes:
      - ./config.toml:/etc/pail/config.toml:ro
      - pail-data:/var/lib/pail
      - opencode-auth:/home/pail/.local/share/opencode
      - opencode-config:/home/pail/.config/opencode
    environment:
      - PAIL_DATA_DIR=/var/lib/pail
      # Option A: pass API keys as env vars (no opencode auth needed)
      # - OPENAI_API_KEY=${OPENAI_API_KEY}
      # - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}

volumes:
  pail-data:
  opencode-auth:
  opencode-config:

# Uncomment to join an external Docker network (e.g., for a Caddy reverse proxy).
# With this, remove the `ports` section above â€” Caddy connects via the network name.
# networks:
#   default:
#     name: caddynet
#     external: true
